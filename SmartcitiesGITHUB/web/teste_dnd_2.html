<!DOCTYPE html>
<html >
    <head>
        <meta charset="utf-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <title>DND</title>
		
		<style>
			@import "themes/claro/document.css";
			@import "themes/claro/claro.css";
			html, body{
				height: 100%;
				width: 100%;
			}
        </style>
		<script type="text/javascript" data-dojo-config="'parseOnLoad':true,'async':true,'packages':[{'name':'shapes','location':'../../shapes'},{'name':'zazl','location':'../../zazl'},{'name':'widgets','location':'../../custom'}],'themeMap':[['Android','',['themes/android/android.css']],['BlackBerry','',['themes/blackberry/blackberry.css']],['iPad','',['themes/ipad/ipad.css']],['iPhone','',['themes/iphone/iphone.css']],['.*','',['themes/iphone/iphone.css']]],'mblThemeFiles':[],'mblLoadCompatPattern':''" src="lib/dojo/dojo/dojo.js"></script>
		
		<script type="text/javascript">
			require([
				"dojo/ready",
				"dojo/dnd/Container",
				"dojo/dnd/Selector",
				"dojo/dnd/Source",
				"dojo/dnd/Moveable",
				"dojo/dom-construct",
				"dojo/dom",
				"dojo/aspect",
				"dijit/tree/dndSource",
				"dijit/Tree",
				"dijit/tree/ObjectStoreModel",
				"dojo/store/Memory",
				"dojo/store/Observable",
				"dojo/domReady!"				
			], 	function(
				ready,
				Container,
				Selector,
				Source,
				Moveable,
				domConstruct,
				dom,
				aspect,
				dndSource,
				Tree,
				StoreModel,
				Memory,
				Observable
				){
				
					ready( function(){
						
						var boxLista = new Source("listaTabelas", {
							creator: function( item, hint ){
								var objDom = domConstruct.toDom("<div>"+item.nome+"</div>");
								return { node: objDom, data: item, type: ["tabela"]};
							},							
							//copyOnly: true,
							accept:["tabela"]							
						});
						
						/**
						  *		Dados e metadados das tabelas ficam dentro desse array de objetos JS.
						  *		Basta que o serviço que fornece os dados retorne um array no padrão JSON.
						  */
						boxLista.insertNodes( false, 
						[							
							{nome:'Pessoa', type:'tabela', campos:["nome","cpf","endereco","dataNasc"]},
							{nome:'Cidade', type:'tabela', campos:["nome", "estado"]},
							{nome:'Estado', type:'tabela', campos:["nome", "uf", "pais"]},
							{nome:'Usuario', type:'tabela', campos:["nome", "senha","permissoes", "tipo"]},
							{nome:'Permissao', type:'tabela', campos:["descricao", "operacao", "leitura", "escrita", "execucao"]}
						]
						);
						
						var boxDrop = new Source("dropArea",{
							creator: function( item, hint ){
								var campos = "";
								for( var i = 0; i < item.campos.length; i++ ){
									campos += "<div style='width:100%;' >" + item.campos[i] + "</div>";
								}
								var objDom = domConstruct.toDom(
									"<div style='width:50px;position:absolute;'>" +
									"<div style='border:1px solid orange;background-color:#EEEEEE;width:100%'>" + item.nome + "</div>" +
									"<div style='border:1px solid brown;width:100%'>" + campos + "</div>" +
									"</div>"
								);
								return { node: objDom, data: item, type: ["tabela"] };
							},
							accept: ["tabela"]
						});
						
					});
			
				}
			);
		</script>
	</head>
	<body class="claro">
	<h3>Itens à esquerda para serem arrastados para a direita</h3>
	<div id="listaTabelas" style="width:200px;height:300px;border:1px solid black;float:left;"></div>
	
	<div id="dropArea" style="width:200px;height:300px;border:1px solid black;float:left;"></div>
	
	</body>
	
</html>